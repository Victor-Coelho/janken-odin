<!DOCTYPE html>
<html>
<head>
    <title>Rock Paper Scissors</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <button id="rock">Rock</button>
    <button id="paper">Paper</button>
    <button id="scissors">Scissors</button>
    <div class = "intro-message"></div>
    <div class="actions"></div>

    <script>
        /* Chooses one of the three possible moves randomly */
        function computerPlay() {
            var array = ["rock", "paper", "scissors"];
            return array[~~(Math.random() * array.length)];
        }
        /* Plays a round of Rock, Paper, Scissors. All strings from user input are set to lower case.
            Uses computerPlay() to get the computer input. */
        function playRound(playerSelection, computerSelection, round_actions) {
            playerSelection = playerSelection.toLowerCase();
            const round_result = document.createElement("p");
            if(playerSelection === computerSelection) {
                round_result.textContent = "It's a draw! Play this round again!";
                round_actions.appendChild(round_result);
                return -1;
            } else if(playerSelection === "rock") {
                if(computerSelection === "paper") {
                    console.log("You Lose! Paper beats Rock");
                    round_result.textContent = "You Lose! Paper beats Rock";
                    round_actions.appendChild(round_result);
                    return 0;
                } else if(computerSelection === "scissors") {
                    console.log("You Win! Rock beats Scissors");
                    round_result.textContent = "You Win! Rock beats Scissors";
                    round_actions.appendChild(round_result);
                    return 1;
                }
            } else if(playerSelection === "paper") {
                if(computerSelection === "rock") {
                    console.log("You Win! Paper beats Rock");
                    round_result.textContent = "You Win! Paper beats Rock";
                    round_actions.appendChild(round_result);
                    return 1;
                } else if(computerSelection === "scissors") {
                    console.log("You Lose! Scissors beats Paper");
                    round_result.textContent = "You Lose! Scissors beats Paper";
                    round_actions.appendChild(round_result);
                    return 0;
                }
            } else if(playerSelection === "scissors") {
                if(computerSelection === "rock") {
                    console.log("You Lose! Rock beats Scissors");
                    round_result.textContent = "You Lose! Rock beats Scissors";
                    round_actions.appendChild(round_result);
                    return 0;
                } else if(computerSelection === "paper") {
                    console.log("You Win! Scissors beats Paper");
                    round_result.textContent = "You Win! Scissors beats Paper";
                    round_actions.appendChild(round_result);
                    return 1;
                }
            } else {
                console.log("Something unexpected happened. Check your spelling.")
                round_result.textContent = "Something unexpected happened. Check your spelling.";
                round_actions.appendChild(round_result);
                return NaN;
            }
        }
        /* Function that runs the game in a "Best of" format. Receives number of desired rounds as input. For this assignment, the preset is 5 rounds. */
        function game(rounds) {
            /* Variables that contain each one of the possible actions of the game. */
            const rock_action = document.querySelector("#rock");
            const paper_action = document.querySelector("#paper");
            const scissors_action = document.querySelector("#scissors");
            /* Variables that contains the divs where text messages will be displayed for the player. */
            const round_actions = document.querySelector(".actions");
            const intro_messages = document.querySelector(".intro-message");
            const welcome_message = document.createElement("p");
            const instructions_message = document.createElement("p");

            welcome_message.textContent = "Welcome to the Rock Paper Scissors game created for the Odin Project Web Dev 101 course. The game was designed by Victor Coelho.";
            instructions_message.textContent = "This is a BO5 match. If the round ends in a draw, that round gets replayed.";

            intro_messages.appendChild(welcome_message);
            intro_messages.appendChild(instructions_message);

            /* Win Counter */
            let playerCounter = 0;
            let computerCounter = 0;
            /* Number of rounds played counter */
            let roundCounter = 0;
            /* Loop that executes the number of rounds specified by the function parameter. */
            while(roundCounter < 5) {
                /*  */
                const score_player = document.createElement("h3");
                const score_comp = document.createElement("h3");
                const score_current = document.createElement("h3");
                /* Displays the current score */
                score_current.textContent = "Current score:"
                score_player.textContent = `Player: ${playerCounter}`;
                score_comp.textContent = `Computer: ${computerCounter}`;

                round_actions.appendChild(score_current);
                round_actions.appendChild(score_player);
                round_actions.appendChild(score_comp);
                /* Discovers what action was selected by the player  */
                rock_action.addEventListener("click", function () {
                    let current_round = playRound("rock", computerPlay(), round_actions);
                });
                paper_action.addEventListener("click", function () {
                    let current_round = playRound("paper", computerPlay(), round_actions);
                });
                scissors_action.addEventListener("click", function () {
                    let current_round = playRound("scissors", computerPlay(), round_actions);
                });
                /* Determines the round winner. Only advances the round if there was a winner.  */
                if( currentRound === 1) {
                    playerCounter++;
                    roundCounter++;
                } else if(currentRound === 0) {
                    computerCounter++;
                    roundCounter++;
                }
            }
            /* After the match is over, prints the results. */
            if(playerCounter > computerCounter) {
                console.log(`You Won the BO${rounds} match ${playerCounter} to ${computerCounter}!`);
            } else if(playerCounter < computerCounter) {
                console.log(`You Lost the BO${rounds} match ${playerCounter} to ${computerCounter}!`);
            } else if(playerCounter === computerCounter) {
                console.log(`The BO${rounds} match ended in a ${playerCounter} to ${computerCounter} draw! `)
            }
        }
        game(5);
    </script>
</body>
</html>